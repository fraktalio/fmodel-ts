"use strict";(self.webpackChunkfmodel_ts_doc=self.webpackChunkfmodel_ts_doc||[]).push([[308],{1598:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>m,frontMatter:()=>o,metadata:()=>l,toc:()=>u});var r=a(4848),t=a(8453),i=a(1470),s=a(9365);const o={sidebar_position:4},c="Aggregating the Behaviour",l={id:"domain/aggregating-the-behaviour",title:"Aggregating the Behaviour",description:"The combine is a binary operation over the decider, view and saga, satisfying associativity and having an",source:"@site/docs/domain/aggregating-the-behaviour.md",sourceDirName:"domain",slug:"/domain/aggregating-the-behaviour",permalink:"/fmodel-ts/docs/domain/aggregating-the-behaviour",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Modeling the Behaviour",permalink:"/fmodel-ts/docs/domain/modeling-the-behaviour"},next:{title:"Specification By Example",permalink:"/fmodel-ts/docs/domain/specification-by-example"}},d={},u=[];function h(e){const n={code:"code",em:"em",h1:"h1",header:"header",hr:"hr",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"aggregating-the-behaviour",children:"Aggregating the Behaviour"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"combine"})," is a binary operation over the ",(0,r.jsx)(n.code,{children:"decider"}),", ",(0,r.jsx)(n.code,{children:"view"})," and ",(0,r.jsx)(n.code,{children:"saga"}),", satisfying associativity and having an\nidentity/empty element."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Associativity facilitates parallelization by giving us the freedom to break problems into chunks that can be computed\nin parallel."})}),"\n",(0,r.jsxs)(n.p,{children:["Functional paradigm and category theory define this algebra as a ",(0,r.jsx)(n.code,{children:"Monoid"}),".\nStated tersely, a ",(0,r.jsx)(n.code,{children:"monoid"})," is a type together with a binary operation (",(0,r.jsx)(n.code,{children:"combine"}),") over that type, satisfying\nassociativity\nand having an identity element (zero/empty)."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsxs)(n.strong,{children:[(0,r.jsx)(n.code,{children:"combine"})," operation is also commutative"]})," / ",(0,r.jsx)(n.em,{children:"commutative"})," ",(0,r.jsx)(n.code,{children:"monoid"})]}),"\n",(0,r.jsxs)(i.A,{groupId:"component-type",queryString:"component-type",children:[(0,r.jsxs)(s.A,{value:"decider",label:"Decider",children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"associative: (decider1 + decider2) + decider3 = decider1 + (decider2 + decider3)\ncommutative: decider1 + decider2 = decider2 + decider1\nzero:        decider1 + decider0 = decider1\n"})}),(0,r.jsx)(n.p,{children:"By combining two or more deciders you get the new decider."}),(0,r.jsxs)(n.p,{children:["This is a formal signature of the ",(0,r.jsx)(n.code,{children:"combine"})," function defined on the ",(0,r.jsx)(n.code,{children:"decider"}),":"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"combine<C2, S2, E2>(decider2: Decider<C2, S2, E2>): Decider<C | C2, S & S2, E | E2>\n"})}),(0,r.jsx)(n.p,{children:"Example:"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const restaurantDecider: Decider<RestaurantCommand, Restaurant | null, RestaurantEvent>\n\nconst orderDecider: Decider<OrderCommand, Order | null, OrderEvent>\n\n// Combining two deciders into one big decider that can handle all commands of the system.\nconst decider: Decider<RestaurantCommand | OrderCommand, (Order & Restaurant) | null, RestaurantEvent | OrderEvent> =\n      restaurantDecider.combine(orderDecider);\n"})}),(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Mappable"})}),(0,r.jsx)(n.hr,{}),(0,r.jsxs)(n.p,{children:["Additionally, ",(0,r.jsx)(n.code,{children:"Decider<C, S, E>"})," provides map functions:"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"mapContraOnCommand<Cn>(f: (cn: Cn) => C): Decider<Cn, S, E>\n\ndimapOnEvent<En>(fl: (en: En) => E, fr: (e: E) => En): Decider<C, S, En>\n\ndimapOnState<Sn>(fl: (sn: Sn) => S, fr: (s: S) => Sn): Decider<C, Sn, E>\n"})})]}),(0,r.jsxs)(s.A,{value:"view",label:"View",children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"associative: (view1 + view2) + view3 = view1 + (view2 + view3)\ncommutative: view1 + view2 = view2 + view1\nzero:        view1 + view0 = view1\n"})}),(0,r.jsx)(n.p,{children:"By combining two or more views you get the new view."}),(0,r.jsxs)(n.p,{children:["This is a formal signature of the ",(0,r.jsx)(n.code,{children:"combine"})," function defined on the ",(0,r.jsx)(n.code,{children:"view"}),":"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"combine<S2, E2>(view2: View<S2, E2>): View<S & S2, E | E2>\n"})}),(0,r.jsx)(n.p,{children:"Example:"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const restaurantView: View<RestaurantView | null, RestaurantEvent>\n\nconst orderView: View<OrderView | null, OrderEvent> \n\n// Combining two views into one big view that can handle all events of the system.\nconst view: View<(RestaurantView & OrderView) | null, OrderEvent | RestaurantEvent> = restaurantView.combine(orderView);\n"})}),(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Mappable"})}),(0,r.jsx)(n.hr,{}),(0,r.jsxs)(n.p,{children:["Additionally, ",(0,r.jsx)(n.code,{children:"View<S, E>"})," provides map functions:"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"mapContraOnEvent<En>(f: (en: En) => E): View<S, En>\n\ndimapOnState<Sn>(fl: (sn: Sn) => S, fr: (s: S) => Sn): View<Sn, E>\n"})})]}),(0,r.jsxs)(s.A,{value:"saga",label:"Saga",children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"associative: (saga1 + saga2) + saga3 = saga1 + (saga2 + saga3)\ncommutative: saga1 + saga2 = saga2 + saga1\nzero:        saga1 + saga0 = saga1\n"})}),(0,r.jsx)(n.p,{children:"By combining two or more sagas you get the new saga."}),(0,r.jsxs)(n.p,{children:["This is a formal signature of the ",(0,r.jsx)(n.code,{children:"combine"})," function defined on the ",(0,r.jsx)(n.code,{children:"saga"}),":"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"combine<AR2, A2>(saga2: Saga<AR2, A2>): Saga<AR | AR2, A | A2>\n"})}),(0,r.jsx)(n.p,{children:"Example:"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const restaurantSaga: Saga<OrderEvent, RestaurantCommand>\nconst orderSaga: Saga<RestaurantEvent, OrderCommand>\n\n// Combining two choreography sagas into one big system orchestrating saga.\nconst saga: Saga<RestaurantEvent | OrderEvent, RestaurantCommand | OrderCommand> = restaurantSaga.combine(orderSaga);\n"})}),(0,r.jsxs)(n.p,{children:["If the constraints are not met, the ",(0,r.jsx)(n.code,{children:"combine"})," function will not be available for usage!"]}),(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Mappable"})}),(0,r.jsx)(n.hr,{}),(0,r.jsxs)(n.p,{children:["Additionally, ",(0,r.jsx)(n.code,{children:"Saga<AR, A>"})," provides map functions:"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"mapContraOnActionResult<ARn>(f: (arn: ARn) => AR): Saga<ARn, A>\n\nmapOnAction<An>(f: (a: A) => An): Saga<AR, An> \n"})})]})]})]})}function m(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},9365:(e,n,a)=>{a.d(n,{A:()=>s});a(6540);var r=a(4164);const t={tabItem:"tabItem_Ymn6"};var i=a(4848);function s(e){let{children:n,hidden:a,className:s}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,r.A)(t.tabItem,s),hidden:a,children:n})}},1470:(e,n,a)=>{a.d(n,{A:()=>y});var r=a(6540),t=a(4164),i=a(3104),s=a(6347),o=a(205),c=a(7485),l=a(1682),d=a(679);function u(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:a}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:a,attributes:r,default:t}}=e;return{value:n,label:a,attributes:r,default:t}}))}(a);return function(e){const n=(0,l.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,a])}function m(e){let{value:n,tabValues:a}=e;return a.some((e=>e.value===n))}function g(e){let{queryString:n=!1,groupId:a}=e;const t=(0,s.W6)(),i=function(e){let{queryString:n=!1,groupId:a}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:n,groupId:a});return[(0,c.aZ)(i),(0,r.useCallback)((e=>{if(!i)return;const n=new URLSearchParams(t.location.search);n.set(i,e),t.replace({...t.location,search:n.toString()})}),[i,t])]}function p(e){const{defaultValue:n,queryString:a=!1,groupId:t}=e,i=h(e),[s,c]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!m({value:n,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=a.find((e=>e.default))??a[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:i}))),[l,u]=g({queryString:a,groupId:t}),[p,v]=function(e){let{groupId:n}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(n),[t,i]=(0,d.Dv)(a);return[t,(0,r.useCallback)((e=>{a&&i.set(e)}),[a,i])]}({groupId:t}),f=(()=>{const e=l??p;return m({value:e,tabValues:i})?e:null})();(0,o.A)((()=>{f&&c(f)}),[f]);return{selectedValue:s,selectValue:(0,r.useCallback)((e=>{if(!m({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);c(e),u(e),v(e)}),[u,v,i]),tabValues:i}}var v=a(2303);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=a(4848);function x(e){let{className:n,block:a,selectedValue:r,selectValue:s,tabValues:o}=e;const c=[],{blockElementScrollPositionUntilNextRender:l}=(0,i.a_)(),d=e=>{const n=e.currentTarget,a=c.indexOf(n),t=o[a].value;t!==r&&(l(n),s(t))},u=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const a=c.indexOf(e.currentTarget)+1;n=c[a]??c[0];break}case"ArrowLeft":{const a=c.indexOf(e.currentTarget)-1;n=c[a]??c[c.length-1];break}}n?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":a},n),children:o.map((e=>{let{value:n,label:a,attributes:i}=e;return(0,b.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>c.push(e),onKeyDown:u,onClick:d,...i,className:(0,t.A)("tabs__item",f.tabItem,i?.className,{"tabs__item--active":r===n}),children:a??n},n)}))})}function j(e){let{lazy:n,children:a,selectedValue:i}=e;const s=(Array.isArray(a)?a:[a]).filter(Boolean);if(n){const e=s.find((e=>e.props.value===i));return e?(0,r.cloneElement)(e,{className:(0,t.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==i})))})}function w(e){const n=p(e);return(0,b.jsxs)("div",{className:(0,t.A)("tabs-container",f.tabList),children:[(0,b.jsx)(x,{...n,...e}),(0,b.jsx)(j,{...n,...e})]})}function y(e){const n=(0,v.A)();return(0,b.jsx)(w,{...e,children:u(e.children)},String(n))}},8453:(e,n,a)=>{a.d(n,{R:()=>s,x:()=>o});var r=a(6540);const t={},i=r.createContext(t);function s(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);